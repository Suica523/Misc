<html>
<head>
  <title>BMZCTF Misc 12ï¼ˆ65-68ï¼‰</title>
  <basefont face="å¾®è½¯é›…é»‘" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605894 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: å¾®è½¯é›…é»‘;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5733"/>
<h1>BMZCTF Misc 12ï¼ˆ65-68ï¼‰</h1>
<h2><a href="https://DemonStarAlgol.github.io/Misc/">[æ— å…³é“¾æ¥]</a></h2>

<div>
<span><div><span style="font-weight: bold;">65Â [RoarCTF2020]Hi_433MHz</span></div><div><br/></div><div>ä¸‹è½½å¾—åˆ°rf.s8æ–‡ä»¶ï¼Œæ²¡è§è¿‡çš„æ‰©å±•åï¼Œfileå‘½ä»¤çœ‹ä¸€ä¸‹æ–‡ä»¶ç±»å‹ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# file rf.s8</div><div>rf.s8: data</div></div><div>å—¯â€¦â€¦æ‰€ä»¥æ˜¯æŸç§æ•°æ®çš„æ–‡ä»¶ï¼Œä»æ–‡ä»¶åé‡Œçš„MHzè¿™ä¸ªå•ä½æ¥çœ‹å¯èƒ½æ˜¯ä¸å£°éŸ³ç›¸å…³çš„æ•°æ®ï¼Œå°è¯•æ‹–è¿›audacityï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>æŒ‰è¯´æ˜å¯¼å…¥æ•°æ®ï¼Œé€‰é¡¹çœ‹ä¸æ‡‚ï¼Œæš‚æ—¶ä¿æŒé»˜è®¤ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>æ‹‰ä¼¸ä¸€ä¸‹æ¨ªåæ ‡è½´ï¼Œå¯ä»¥çœ‹åˆ°é•¿éŸ³å’ŒçŸ­éŸ³ç»„æˆçš„å¤šç»„å£°éŸ³ä¿¡å·ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>è§‚å¯Ÿä¸€ä¸‹è§„å¾‹ï¼š</div><div>1ã€æ¯ç»„æœ‰9ä¸ªå£°éŸ³ä¿¡å·ï¼›</div><div>2ã€æ¯ç»„çš„å¼€å¤´å’Œç»“å°¾å¿…ç„¶æ˜¯çŸ­éŸ³ã€‚</div><div>å°è¯•å°†é•¿éŸ³å’ŒçŸ­éŸ³åˆ†åˆ«æ›¿æ¢æˆ1å’Œ0ï¼Œè®°å½•å¼€å¤´å››ç»„ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>011001100 011011000 011000010 011001110</div></div><div>è”æƒ³åˆ° flag çš„äºŒè¿›åˆ¶ASCIIç ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01100110 01101100 01100001 01100111</div></div><div>æ˜¾ç„¶æ¯ç»„å£°éŸ³ä¿¡å·å»æ‰æœ«å°¾çš„0å°±æ˜¯å¯¹åº”å­—ç¬¦çš„äºŒè¿›åˆ¶ASCIIç ã€‚</div><div><br/></div><div>è®°å½•å…¨éƒ¨å£°éŸ³ä¿¡å·ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>011001100 011011000 011000010 011001110 011110110 001100100 001101010 011000110 001100100 001100010 011000100 001100000 011001000 001011010 001101100 011000010 001100010 001100010 001011010 001101000 001100110 001100010 001100100 001011010 001110010 001101110 001100010 011000100 001011010 001101000 001100100 001110000 011001000 001100000 001100010 011000110 011001000 011000110 001101010 001100110 001101000 011111010</div></div><div>å»æ‰æ¯ç»„æœ«å°¾çš„0ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>01100110 01101100 01100001 01100111 01111011 00110010 00110101 01100011 00110010 00110001 01100010 00110000 01100100 00101101 00110110 01100001 00110001 00110001 00101101 00110100 00110011 00110001 00110010 00101101 00111001 00110111 00110001 01100010 00101101 00110100 00110010 00111000 01100100 00110000 00110001 01100011 01100100 01100011 00110101 00110011 00110100 01111101</div></div><div>äºŒè¿›åˆ¶ASCIIè½¬ç ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{25c21b0d-6a11-4312-971b-428d01cdc534}</div></div><div><br/></div><div>flagï¼šflag{25c21b0d-6a11-4312-971b-428d01cdc534}</div><div><br/></div><div><span style="font-weight: bold;">66Â crymisc</span></div><div><br/></div><div>ä¸‹è½½å¾—åˆ°docxæ ¼å¼æ–‡ä»¶ã€‚ç›´æ¥æ‰“å¼€æŠ¥é”™ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>ç”¨7-Zipä½œä¸ºå‹ç¼©æ–‡ä»¶æ‰“å¼€ï¼Œå†…å«1.txtå’Œ3.jpgï¼Œæ³¨æ„åˆ°3.jpgæ˜¯åŠ å¯†å‹ç¼©çš„ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>å°è¯•è§£å‹ï¼Œ1.txtä¸­ä¸å«æœ‰æ•ˆä¿¡æ¯ï¼ŒåŒæ—¶å¯ä»¥å‘ç°ç”¨7-Zipè§£å‹3.jpgæ—¶æœªå¼¹å‡ºå¯†ç è¾“å…¥æ¡†ï¼Œè€Œæ˜¯ç›´æ¥æç¤ºå¯†ç é”™è¯¯ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>è¯´æ˜ä¼ªåŠ å¯†çš„å¯èƒ½æ€§å¾ˆå¤§ï¼ŒZIpCenOpå¤„ç†ä¸€ä¸‹ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>D:\CTFToolkit-v1.1.0\æš´åŠ›ç ´è§£\ZipCenOp&gt;java -jar ZipCenOp.jar r crymisc.docx</div><div>success 2 flag(s) found</div></div><div>ç„¶åè§£å‹å¾—åˆ°3.jpgã€‚</div><div><br/></div><div>åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€3.jpgï¼Œæ–‡ä»¶å°¾åæœ‰é¢å¤–æ•°æ®ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div>é¦–å…ˆæ˜¯ä¸€æ®µå­—ç¬¦ä¸²ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>SSB3YXMgcmVqZWN0ZWQuLi4uLi5USElTIElTIFRIRSBQQVNTV09SRDpJIFdhbm5hIENyeXl5ISEh</div></div><div>base64è§£ç ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>I was rejected......THIS IS THE PASSWORD:I Wanna Cryyy!!!</div></div><div>æ¥ä¸‹æ¥æ³¨æ„åˆ°å­—ç¬¦ä¸²ä¹‹åï¼Œ0x31AEå¼€å§‹çš„ä¸¤å­—èŠ‚ä¸º03 04ï¼Œç»“åˆåç»­å­—èŠ‚å¯ä»¥åˆ¤å®šè¿™æ˜¯ä¸€ä¸ªç¼ºå°‘äº†æ–‡ä»¶å¤´ä¸¤å­—èŠ‚50 4Bçš„zipæ ¼å¼å‹ç¼©åŒ…ã€‚å°†å…¶æå–åè¡¥å…¨æ–‡ä»¶å¤´ï¼Œè·å–åŠ å¯†å‹ç¼©åŒ…ï¼Œç”¨base64è§£ç è·å¾—çš„å¯†ç è§£å‹ï¼Œå¾—åˆ°crymisc.txtï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ğŸ”­ğŸ’™ğŸ°âœŠğŸŒ»ğŸ§ğŸ’™ğŸ˜˜ğŸŒ»ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸšğŸŠğŸ‘¹ğŸ¶ğŸ˜€ğŸ¶ğŸ˜€ğŸ˜˜ğŸ‘¹ğŸ’™ğŸ‚ğŸ’‡ğŸ˜€ğŸ˜€ğŸ˜©ğŸŒ»ğŸŸğŸ‘‚ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸ‘†ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸš”ğŸ¶ğŸ‘‰âœŠğŸ˜±ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸšŠğŸ˜§ğŸ’¨ğŸ’™ğŸ’•</div><div>That is what i told herâ†‘â†‘â†‘</div></div><div>æ˜¯ä¸€ä¸²emojiã€‚å¸¸è§çš„ä»¥emojiä¸ºå¯†æ–‡çš„åŠ å¯†æ–¹å¼åŒ…æ‹¬<a href="https://foundation.mozilla.org/en/campaigns/codemoji/">codemoji</a>ã€<a href="https://aghorler.github.io/emoji-aes/">emoji-aes</a>æˆ–ä»¥emojiç¬¦å·ä¸ºå­—ç¬¦è¡¨çš„<a href="https://github.com/AdamNiederer/base100">base100</a>ï¼Œç»è¿‡å°è¯•å¯ä»¥æ’é™¤base100ä»¥åŠéœ€è¦å¯†é’¥çš„emoji-aesã€‚ç”±Mozillaå¼€å‘çš„codemojiè™½ç„¶ä¹Ÿéœ€è¦å¯†é’¥ï¼Œä½†å…¶å¯†é’¥ä¸ºå•ä¸ªemojiç¬¦å·ï¼Œå› æ­¤å¯ä»¥åœ¨æœ‰é™æ—¶é—´å†…çˆ†ç ´ã€‚</div><div><br/></div><div>ä»githubæ‰¾åˆ°å¯¹åº”çš„<a href="https://github.com/pavelvodrazka/ctf-writeups/tree/master/hackyeaster2018/challenges/egg17/files/cracker">cracker</a>å·¥å…·ï¼Œæ‰“å¼€cracker.htmlï¼Œå¡«å…¥å¯†æ–‡åç‚¹å‡»Decryptï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>ä»è€Œå¾—åˆ°å¯†é’¥å’Œæ˜æ–‡ã€‚</div><div><br/></div><div>flagï¼šGACTF{H4ppy_Mi5c_H4ppy_L1fe}</div><div><br/></div><div><span style="font-weight: bold;">67Â [2020é¦–å±Šç¥¥äº‘æ¯]xixixi</span></div><div>é¢˜ç›®ï¼šå®¤å‹æœ€è¿‘æ²‰è¿·yç¥ï¼Œåˆæ°ªåˆè‚ï¼Œè¿˜ghsã€‚ä¸ºäº†ä»–çš„èº«ä½“ç€æƒ³ï¼Œæˆ‘æŠŠä»–çš„så›¾æ•´æ²¡äº†ã€‚ä½†æˆ‘æ˜æ˜åˆ äº†è„šæœ¬å•Šï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½è¢«ä»–å‘ç°......8è¯´äº†ï¼ŒåŒ»é™¢çš„ç©ºè°ƒçœŸèˆ’æœ~ã€‚</div><div><br/></div><div>ä¸‹è½½å¾—åˆ°vhdæ ¼å¼æ–‡ä»¶ã€‚è¿™æ˜¯å¾®è½¯è™šæ‹Ÿç£ç›˜ï¼ˆMicrosoft Virtual Hard Disk formatï¼‰æ ¼å¼é•œåƒï¼Œç”¨DiskGeniusæ‰“å¼€ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>å¯ä»¥æ‰¾åˆ°ä¸€å¼ kejin.pngï¼Œä½†æ–‡ä»¶ç»“æ„å·²è¢«æŸåï¼Œç”¨å¯ä»¥å¿½ç•¥é”™è¯¯çš„å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€ä¹Ÿä»…èƒ½çœ‹åˆ°æœ€ä¸Šæ–¹ä¸€éƒ¨åˆ†å†…å®¹ã€‚æ ¹æ®é¢˜ç›®å†…å®¹ï¼Œæœ‰æŸä¸ªè„šæœ¬è¢«åˆ æ‰äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å›æ”¶ç«™ç›®å½•ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>æœ‰4ä¸ªpyæ ¼å¼æ–‡ä»¶ï¼Œæ¢å¤åé€ä¸ªæŸ¥çœ‹ï¼Œå‘ç°$RQLO56E.pyå’Œ$RXSRKT0.pyä¸­æœ‰å¯è¯†åˆ«å†…å®¹ï¼Œåˆ†åˆ«ä¸ºï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div><br/></div><div>class FAT32Parser(object):</div><div>Â Â Â Â def __init__(self, vhdFileName):</div><div>Â Â Â Â Â Â Â Â with open(vhdFileName, 'rb') as f:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â self.diskData = f.read()</div><div>Â Â Â Â Â Â Â Â self.DBR_off = self.GetDBRoff()</div><div>Â Â Â Â Â Â Â Â self.newData = ''.join(self.diskData)Â  # åç»­æ­¥éª¤éœ€è¦æ³¨é‡Šæ‰è¿™ä¸€è¡Œå†ç»§ç»­ï¼Œå¦åˆ™è¿è¡Œå¯èƒ½æŠ¥é”™</div><div><br/></div><div>Â Â Â Â def GetDBRoff(self):</div><div>Â Â Â Â Â Â Â Â DPT_off = 0x1BE</div><div>Â Â Â Â Â Â Â Â target = self.diskData[DPT_off+8:DPT_off+12]</div><div>Â Â Â Â Â Â Â Â DBR_sector_off, = struct.unpack(&quot;&lt;I&quot;, target)</div><div>Â Â Â Â Â Â Â Â return DBR_sector_off * 512</div><div><br/></div><div>Â Â Â Â def GetFAT1off(self):</div><div>Â Â Â Â Â Â Â Â target = self.diskData[self.DBR_off+0xE:self.DBR_off+0x10]</div><div>Â Â Â Â Â Â Â Â FAT1_sector_off, = struct.unpack(&quot;&lt;H&quot;, target)</div><div>Â Â Â Â Â Â Â Â return self.DBR_off + FAT1_sector_off * 512</div><div><br/></div><div>Â Â Â Â def GetFATlength(self):</div><div>Â Â Â Â Â Â Â Â target = self.diskData[self.DBR_off+0x24:self.DBR_off+0x28]</div><div>Â Â Â Â Â Â Â Â FAT_sectors, = struct.unpack(&quot;&lt;I&quot;, target)</div><div>Â Â Â Â Â Â Â Â return FAT_sectors * 512</div><div><br/></div><div>Â Â Â Â def GetRootoff(self):</div><div>Â Â Â Â Â Â Â Â FAT_length = self.GetFATlength()</div><div>Â Â Â Â Â Â Â Â FAT2_off = self.GetFAT1off() + FAT_length</div><div>Â Â Â Â Â Â Â Â return FAT2_off + FAT_length</div><div><br/></div><div>Â Â Â Â def Cluster2FAToff(self, cluster):</div><div>Â Â Â Â Â Â Â Â FAT1_off = self.GetFAT1off()</div><div>Â Â Â Â Â Â Â Â return FAT1_off + cluster * 4</div><div><br/></div><div>Â Â Â Â def Cluster2DataOff(self, cluster):</div><div>Â Â Â Â Â Â Â Â rootDir_off = self.GetRootoff()</div><div>Â Â Â Â Â Â Â Â return rootDir_off + (cluster - 2) * 512</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import struct</div><div>from xixi import FAT32Parser</div><div>from xixixi import Padding, picDepartList</div><div><br/></div><div>def EncodePieces():</div><div>Â Â Â Â global clusterList</div><div>Â Â Â Â res = []</div><div>Â Â Â Â Range = len(picDepartList)Â Â Â Â # 58</div><div>Â Â Â Â # GetRandomClusterList(n) - Generate a random cluster list with length n</div><div>Â Â Â Â clusterList = GetRandomClusterList(Range)</div><div><br/></div><div>Â Â Â Â for i in range(Range):</div><div>Â Â Â Â Â Â Â Â if i != Range - 1:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â newCRC = struct.pack(&quot;&lt;I&quot;, clusterList[i+1])</div><div>Â Â Â Â Â Â Â Â Â Â Â Â plainData = picDepartList[i][:-4] + newCRC</div><div>Â Â Â Â Â Â Â Â else:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â plainData = picDepartList[i]</div><div><br/></div><div>Â Â Â Â Â Â Â Â # Show the first piece to him, hhh</div><div>Â Â Â Â Â Â Â Â if i == 0:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â newPiece = plainData</div><div>Â Â Â Â Â Â Â Â else:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â newPiece = ''</div><div>Â Â Â Â Â Â Â Â Â Â Â Â key = clusterList[i] &amp; 0xFE</div><div>Â Â Â Â Â Â Â Â Â Â Â Â for j in plainData:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â newPiece += chr(ord(j) ^ key)</div><div>Â Â Â Â Â Â Â Â # Padding() -- Fill to an integral multiple of 512 with \xFF</div><div>Â Â Â Â Â Â Â Â res.append(Padding(newPiece))</div><div>Â Â Â Â return res</div></div><div>åè€…importçš„ä¸¤ä¸ªåº“ä¸­ï¼Œxixiæ˜¾ç„¶å°±æ˜¯$RQLO56E.pyï¼Œxixixiæš‚æ—¶æœªçŸ¥ã€‚æ•´ç†ä¸€ä¸‹åè€…çš„ä»£ç é€»è¾‘ï¼š</div><div>1ã€å°†å›¾ç‰‡æ•´ä½“åˆ†ä¸º58å—ï¼Œå¹¶å‡†å¤‡å°†å…¶éšæœºåˆ†å¸ƒäºç£ç›˜ä¸­çš„ä¸åŒç°‡ä¸­ï¼›</div><div>2ã€é™¤äº†æœ€åä¸€å—ä»¥å¤–ï¼Œæ¯å—çš„æœ€åå››ä½CRCæ ¡éªŒå­—èŠ‚è¢«æ›¿æ¢æˆäº†ä¸‹ä¸€å—çš„ç°‡å·ï¼›</div><div>3ã€é™¤äº†ç¬¬ä¸€å—ä»¥å¤–ï¼Œæ¯å—çš„å­—èŠ‚éƒ½ä¸keyè¿›è¡Œäº†å¼‚æˆ–åŠ å¯†ï¼Œkeyçš„å€¼æ˜¯ è¯¥å—çš„ç°‡å· &amp; 0xFE çš„ç»“æœã€‚</div><div>å¯ä»¥å‘ç°ï¼Œæ‰“ä¹±åçš„58å—å®é™…ä¸Šæ˜¯åˆ†å¸ƒåœ¨ç£ç›˜çš„ä¸è¿ç»­ç°‡ä¸­çš„ï¼Œç£ç›˜æ“ä½œç”±xixiä¸­çš„FAT32Parserç±»æ‰§è¡Œã€‚å› æ­¤æŒ‚è½½é•œåƒåç›´æ¥å¯¼å‡ºçš„kejin.pngä¸­å¹¶ä¸åŒ…å«å®Œæ•´æ•°æ®ï¼Œåç»­å—çš„æ•°æ®éœ€è¦ç›´æ¥ä»é•œåƒä¸­å–å¾—ã€‚</div><div><br/></div><div>é‡å‘½åxixi.pyï¼Œç„¶åå†™ä¸ªè¿˜åŸè„šæœ¬ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import binascii</div><div>from xixi import FAT32Parser</div><div><br/></div><div>def xor(bindata, key):</div><div>Â Â Â Â out = b''</div><div>Â Â Â Â for i in bindata:</div><div>Â Â Â Â Â Â Â Â out += (i ^ key).to_bytes(1, 'big')</div><div>Â Â Â Â return out</div><div><br/></div><div>data = open('C:/Users/Administrator/Desktop/new.vhd', 'rb')</div><div>res = open('C:/Users/Administrator/Desktop/kejin.png', 'ab')</div><div>start = data.read().index(b'\x89\x50\x4e\x47')</div><div>data.seek(start)</div><div>res.write(data.read(8))</div><div><br/></div><div>FAT = FAT32Parser('C:/Users/Administrator/Desktop/new.vhd')</div><div>key = 0</div><div><br/></div><div>while True:</div><div>Â Â Â Â length, ctype = xor(data.read(4), key), xor(data.read(4), key)</div><div>Â Â Â Â dat = xor(data.read(int.from_bytes(length, 'big')), key)</div><div>Â Â Â Â crc = xor(data.read(4), key)</div><div>Â Â Â Â res.write(length + ctype + dat + crc) # æ²¡æœ‰æ”¹ä¸ºæ­£ç¡®CRCï¼Œå› æ­¤éƒ¨åˆ†å›¾ç‰‡æŸ¥çœ‹å™¨ä¸­å¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤º</div><div><br/></div><div>Â Â Â Â ifÂ Â binascii.crc32(ctype + dat) &amp; 0xffffffff != int.from_bytes(crc, 'big'):</div><div>Â Â Â Â Â Â Â Â cluster = int.from_bytes(crc, 'little')</div><div>Â Â Â Â Â Â Â Â print(cluster)</div><div>Â Â Â Â Â Â Â Â data.seek(FAT.Cluster2DataOff(cluster))</div><div>Â Â Â Â Â Â Â Â key = cluster &amp; 0xFE</div><div><br/></div><div>Â Â Â Â if ctype == b'IEND':</div><div>Â Â Â Â Â Â Â Â break</div></div><div>è¿è¡Œå¾—åˆ°å›¾ç‰‡ï¼ˆå·²ç¼©å°ï¼‰ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>æŒ‰ç…§ä»ä¸Šå¾€ä¸‹é¡ºåºæ‹¼æ¥å¾—åˆ°flagã€‚</div><div><br/></div><div>flagï¼šflag{0cfdd1ad80807da6c0413de606bb0ae4}</div><div><br/></div><div><span style="font-weight: bold;">68Â 2018 hackergame æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡</span></div><div><br/></div><div>ä¸‹è½½å¾—åˆ°é¢˜ç›®æè¿°.docxå’Œ25å¼ æ–‡ä»¶åä¸ºä¹±ç çš„PNGæ ¼å¼å›¾ç‰‡ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>é¢˜ç›®æè¿°æœ‰ç‚¹é•¿ï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯è¦æ‹¼å›¾ï¼Œé‚£ä¹ˆå°±å¼€å§‹æ‹¼ã€‚</div><div><br/></div><div>é¦–å…ˆç”¨ImageMagickçš„montageå‘½ä»¤æŠŠå›¾ç‰‡æ‹¼æˆ5x5çš„ä¸€å¤§å¼ ï¼Œ5x5æ˜¯æ ¹æ®é¢˜ç›®æè¿°é‡Œçš„æ ·å›¾åˆ¤æ–­çš„ï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\Users\Administrator\Desktop\fragments&gt;magick montage *.png -tile 5x5 -geometry 125x125+0+0 out.png</div></div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/out.png" type="image/png" data-filename="out.png"/></div><div>ç„¶åä¸Šgapsï¼š</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop/gaps/bin# python gaps --image=out.png --generations=50 --population=25 --size=125 --save</div></div><div>ç”±äºåŸå›¾ç”»é¢æ¯”è¾ƒç®€å•ï¼Œå¯èƒ½ä¼šè·‘å‡ºæ¯”è¾ƒå¾®å¦™çš„ç»“æœï¼Œä¾‹å¦‚ï¼š</div><div><img src="BMZCTF Misc 12ï¼ˆ65-68ï¼‰_files/out_solution.jpg" type="image/jpeg" data-filename="out_solution.jpg"/></div><div>å®é™…ä¸Šå·²ç»è¶³å¤Ÿçœ‹å‡ºflagï¼Œå½“ç„¶æœ‰å¼ºè¿«ç—‡çš„è¯ä¹Ÿå¯ä»¥å¤šè·‘å‡ éæ‰¾åˆ°æ›´å¥½çš„ç»“æœï¼ˆè¯è¯´åœ¨å‰é¢ï¼Œä¸ä¸€å®šèƒ½æ‰¾åˆ°ï¼‰ï¼Œæˆ–è€…ç”¨é¡ºæ‰‹çš„å›¾åƒç¼–è¾‘è½¯ä»¶è‡ªå·±å†æ‹¼ä¸€ä¸‹ã€‚</div><div><br/></div><div>flagï¼šflag{H4PPY_1M4GE_PR0CE551NG}</div></span>
</div></body></html> 